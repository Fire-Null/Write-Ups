# CVE-2024-4040 LFI admin take over Exploit
## A server side template injection vulnerability in CrushFTP in all versions before 10.7.1 and 11.1.0 on all platforms allows unauthenticated remote attackers to read files from the filesystem outside of the VFS Sandbox, bypass authentication to gain administrative access, and perform remote code execution on the server.

* Further analysis by Rapid7 revealed that the vulnerability is more accurately characterized as a "server-side template injection (SSTI)" vulnerability.This type of flaw allows attackers to inject malicious code into the server-side application, in this case CrushFTP, leading to the ability to read arbitrary files, bypass authentication, and execute remote code.

* As you can see the vulnerability will lead to admin account take over and system file read with root privilage like shadow file
![2024-04-29_13-56](https://github.com/Fire-Null/Write-Ups/assets/131773602/f80d3f28-18e5-4d11-b5a4-8d9725ada81d)
![2024-04-29_14-10](https://github.com/Fire-Null/Write-Ups/assets/131773602/bb9d3a3e-49f6-4296-8939-45e75e5211cf)

## Usage

`python3 base.py https://localhost/`

## Google dork

`intitle:"CrushFTP WebInterface" inurl:/WebInterface/login.html`

## Shodan

`http.favicon.hash:-1022206565`

## Fofa

`http.favicon.hash:-1022206565`

## References

https://attackerkb.com/topics/20oYjlmfXa/cve-2024-4040/rapid7-analysis

## Disclaimer

This tool is purely for ethical and educational purposes only, use it at your own risk.

---
